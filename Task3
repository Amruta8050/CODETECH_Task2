# ============================================
# Task 3: Exploratory Data Analysis (EDA)
# Dataset: Iris Dataset
# Tools: Pandas, Matplotlib, Seaborn
# ============================================

# Step 1: Import required libraries
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Step 2: Load Iris Dataset
from sklearn.datasets import load_iris

iris = load_iris()
df = pd.DataFrame(iris.data, columns=iris.feature_names)
df['species'] = iris.target
df['species'] = df['species'].map({
    0: 'Setosa',
    1: 'Versicolor',
    2: 'Virginica'
})

# Step 3: Basic Data Understanding
print("Dataset Shape:", df.shape)
print("\nDataset Information:")
print(df.info())
print("\nStatistical Summary:")
print(df.describe())

# Step 4: Histogram of Numerical Features
df.hist(figsize=(10, 8))
plt.suptitle("Histogram of Numerical Features", fontsize=14)
plt.show()

# Insight:
# Numerical features show different distributions.
# Petal features show clear separation.

# Step 5: Count Plot for Categorical Feature
plt.figure(figsize=(6,4))
sns.countplot(x='species', data=df)
plt.title("Count of Each Iris Species")
plt.show()

# Insight:
# All three species have equal number of samples.

# Step 6: Box Plot to Identify Outliers
plt.figure(figsize=(8,5))
sns.boxplot(data=df.drop('species', axis=1))
plt.title("Box Plot for Outlier Detection")
plt.show()

# Insight:
# Some outliers exist in sepal width.
# Petal features are more consistent.

# Step 7: Correlation Heatmap
plt.figure(figsize=(8,6))
sns.heatmap(
    df.drop('species', axis=1).corr(),
    annot=True,
    cmap='coolwarm'
)
plt.title("Correlation Heatmap")
plt.show()

# Insight:
# Strong positive correlation between petal length and petal width.
# Sepal features have weaker correlation.

# Step 8: Feature Importance (EDA Perspective)
print("\nImportant Features for Prediction:")
print("- Petal Length")
print("- Petal Width")

# Step 9: Final Summary
print("\nSummary of Findings:")
print("- Dataset contains 150 records with no missing values.")
print("- Petal features are highly correlated and important for classification.")
print("- Minimal outliers detected.")
print("- Dataset is suitable for machine learning models.")
